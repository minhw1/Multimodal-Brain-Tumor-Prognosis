#  뇌종양 예후 예측
환자의 MRI 영상 및 임상 정보를 기반으로, 지정된 시간 간격(ex: 6개월 후) 이후의 뇌종양 **부피Volume**를 수치적으로 정량 예측, **영역mask**을 예측하는 회귀 기반 모델을 개발한다.
<br><br>
## 흐름
+ 데이터 로딩 및 전처리(VIT&LLM) 후 정규화
  <br>-BraTS 데이터셋(2021)을 다운로드하고 MRI 이미지를 정규화
  <br>-환자의 메타데이터(나이, 성별, 병력 등)를 텍스트 형식으로 정리
+ Vision Transformer (ViT) 모델 구축
  <br>-MRI 영상에서 종양의 특징을 추출하는 모델
  <br>-사전 학습된 ViT 모델을 활용하거나, BraTS 데이터로 미세 조정(Fine-tuning)
+ LLM 기반 텍스트 인코더
  <br>-환자의 병력, 진료 기록 등을 벡터로 변환
  <br>-GPT 계열 모델이나 BERT 기반의 모델을 사용할 수 있음
+ 멀티모달 결합(Fusion Module)
  <br>-ViT의 영상 특징과 LLM의 임상 정보 특징을 결합
  <br>-Multimodal Fusion Module사용 가능
---
+ 회귀 모델 (부피 예측)=수치
  <br>-결합된 특징을 입력으로 받아 6개월 후의 종양 부피를 예측하는 회귀 모델 구현
  <br>-MSE(Mean Squared Error) 등의 손실 함수 사용
+ 세그멘테이션 모델 (Future Mask 예측)=형태
  <br>-결합된 특징을 입력으로 받아 6개월 후의 종양 마스크를 예측
  <br>-U-Net 또는 ViT 기반 세그멘테이션 모델 사용
<br><br>
## 사용 데이터
BraTS2021
>+ 의료 영상 자료
>+ 3D 뇌 MRI 스캔을 기반으로 한 볼륨 데이터
>+ 한 환자의 MRI는 여러 슬라이스로 구성된 3차원 영상이며, 보통 다음과 같은 4가지 시퀀스가 제공된다.
> ![Image](https://github.com/user-attachments/assets/3b1877c0-d128-48cd-b9f3-8f667014f5e3)
>>1. ~~T1-weighted (T1)~~ 주로 사용안함
>>2. T1 with contrast enhancement (T1ce)
>>3. T2-weighted (T2)
>>4. FLAIR (Fluid Attenuated Inversion Recovery)
<br><br>
## 주요 기술
### 1. 전처리
모델에 데이터를 넣기 전에 데이터를 깨끗하게 정리하고 준비하는 과정
+ 정규화 ( 크기, 밝기 등 )
>  보통 픽셀 값을 0~1 사이 혹은 Z-score 정규화로 변경  [ 차이점 ](#정규화-비교) <br>
> ![Image](https://github.com/user-attachments/assets/2ea431be-e9ac-4792-8f74-32e3c3332a55)
+ 배경 제거 ( 데이터 상태에 따라 다름 )

### 2. 데이터 증강 기법
기존에 있던 데이터를 인위적으로 회전, 이동, 확대 등을 통하여 기존의 데이터를 확장시켜 학습에 충분한 데이터를 확보한다.
> ![Image](https://github.com/user-attachments/assets/3bbb0489-1671-4fcb-b303-fff603008556)
### 3. 정규화
### 4. 뇌종양 이미지 분할
### 5. CNN모델?

## 정규화 비교
| 항목           | 0~1 스케일링                | Z-score 정규화                      |
|----------------|------------------------------|-------------------------------------|
| 기준           | 최솟값, 최댓값  (0~1)             | 평균(0), 표준편차(1)                      |
| 아웃라이어 민감도 | 민감함                       | 덜 민감함                           |
| 주요 사용처     | CNN, 기본 이미지 전처리      | ViT, 통계 기반 모델, 분석 전처리   |
| 정렬 효과       | 스케일 맞춤                  | 중심 위치 및 분산 정렬             |
